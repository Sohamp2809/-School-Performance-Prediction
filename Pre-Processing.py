{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "8f835075",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "\n",
    "file_path = r\"C:\\Users\\psoha\\OneDrive\\Desktop\\Final Raw Data.csv\"\n",
    "\n",
    "data = pd.read_csv(file_path)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "9f552375",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>School Name</th>\n",
       "      <th>City</th>\n",
       "      <th>AP Classes?</th>\n",
       "      <th>Dual Enrollment?</th>\n",
       "      <th>Offers Electives?</th>\n",
       "      <th>Math Score</th>\n",
       "      <th>English Score</th>\n",
       "      <th>National Rank</th>\n",
       "      <th>AZ Rank</th>\n",
       "      <th>Racial%-White</th>\n",
       "      <th>Racial%-Black</th>\n",
       "      <th>Racial%-Native</th>\n",
       "      <th>Racial%-Hispanic</th>\n",
       "      <th>Racial%-Asian</th>\n",
       "      <th>Racial%-Other</th>\n",
       "      <th>student_faculty_ratio</th>\n",
       "      <th>school_type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Arizona Lutheran Academy</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>28</td>\n",
       "      <td>28</td>\n",
       "      <td>3002</td>\n",
       "      <td>25</td>\n",
       "      <td>57</td>\n",
       "      <td>6</td>\n",
       "      <td>10</td>\n",
       "      <td>15</td>\n",
       "      <td>12</td>\n",
       "      <td>0</td>\n",
       "      <td>32.7</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arizona Preparatory Academy</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>17</td>\n",
       "      <td>22</td>\n",
       "      <td>19568</td>\n",
       "      <td>310</td>\n",
       "      <td>12</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "      <td>71</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>32.8</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Arizona School For The Arts</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>27</td>\n",
       "      <td>30</td>\n",
       "      <td>481</td>\n",
       "      <td>145</td>\n",
       "      <td>63</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>30.2</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Arizona Virtual Academy</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>19</td>\n",
       "      <td>32</td>\n",
       "      <td>3,635</td>\n",
       "      <td>980</td>\n",
       "      <td>69</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>15</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>30.6</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Asdb/phoenix Day school</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1834</td>\n",
       "      <td>16</td>\n",
       "      <td>7</td>\n",
       "      <td>6</td>\n",
       "      <td>67</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>476</th>\n",
       "      <td>Madison Highland Prep</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>43%</td>\n",
       "      <td>40%</td>\n",
       "      <td>15985</td>\n",
       "      <td>280</td>\n",
       "      <td>32%</td>\n",
       "      <td>6%</td>\n",
       "      <td>4%</td>\n",
       "      <td>53%</td>\n",
       "      <td>2%</td>\n",
       "      <td>4%</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>477</th>\n",
       "      <td>Maryvale High School</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>42%</td>\n",
       "      <td>42%</td>\n",
       "      <td>273</td>\n",
       "      <td>14</td>\n",
       "      <td>3%</td>\n",
       "      <td>4%</td>\n",
       "      <td>1%</td>\n",
       "      <td>92%</td>\n",
       "      <td>0%</td>\n",
       "      <td>0%</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>478</th>\n",
       "      <td>Metro Tech High School</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>30%</td>\n",
       "      <td>30%</td>\n",
       "      <td>2497</td>\n",
       "      <td>89</td>\n",
       "      <td>2%</td>\n",
       "      <td>1%</td>\n",
       "      <td>0%</td>\n",
       "      <td>96%</td>\n",
       "      <td>0%</td>\n",
       "      <td>0%</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>479</th>\n",
       "      <td>Metrocenter Academy</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>70</td>\n",
       "      <td>52</td>\n",
       "      <td>18313</td>\n",
       "      <td>337</td>\n",
       "      <td>26%</td>\n",
       "      <td>9%</td>\n",
       "      <td>5%</td>\n",
       "      <td>57%</td>\n",
       "      <td>1%</td>\n",
       "      <td>3%</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>480</th>\n",
       "      <td>Metropolitan Arts Institute</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>60</td>\n",
       "      <td>80</td>\n",
       "      <td>15846</td>\n",
       "      <td>277</td>\n",
       "      <td>52%</td>\n",
       "      <td>5%</td>\n",
       "      <td>0%</td>\n",
       "      <td>36%</td>\n",
       "      <td>1%</td>\n",
       "      <td>6%</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>481 rows Ã— 17 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     School Name     City AP Classes? Dual Enrollment?  \\\n",
       "0       Arizona Lutheran Academy  Phoenix         Yes              Yes   \n",
       "1    Arizona Preparatory Academy  Phoenix         Yes              Yes   \n",
       "2    Arizona School For The Arts  Phoenix         Yes              Yes   \n",
       "3        Arizona Virtual Academy  Phoenix         Yes              Yes   \n",
       "4        Asdb/phoenix Day school  Phoenix          No              Yes   \n",
       "..                           ...      ...         ...              ...   \n",
       "476        Madison Highland Prep  Phoenix         NaN              NaN   \n",
       "477         Maryvale High School  Phoenix         NaN              NaN   \n",
       "478       Metro Tech High School  Phoenix         NaN              NaN   \n",
       "479          Metrocenter Academy  Phoenix         NaN              NaN   \n",
       "480  Metropolitan Arts Institute  Phoenix         NaN              NaN   \n",
       "\n",
       "    Offers Electives? Math Score English Score National Rank AZ Rank  \\\n",
       "0                 Yes         28            28          3002      25   \n",
       "1                 Yes         17            22         19568     310   \n",
       "2                 Yes         27            30           481     145   \n",
       "3                 Yes         19            32         3,635     980   \n",
       "4                 yes          5             5           NaN    1834   \n",
       "..                ...        ...           ...           ...     ...   \n",
       "476               NaN        43%           40%         15985     280   \n",
       "477               NaN        42%           42%           273      14   \n",
       "478               NaN        30%           30%          2497      89   \n",
       "479               NaN         70            52         18313     337   \n",
       "480               NaN         60            80         15846     277   \n",
       "\n",
       "    Racial%-White Racial%-Black Racial%-Native Racial%-Hispanic Racial%-Asian  \\\n",
       "0              57             6             10               15            12   \n",
       "1              12            11              1               71             1   \n",
       "2              63             4              1               22             5   \n",
       "3              69             6              2               15             1   \n",
       "4              16             7              6               67             2   \n",
       "..            ...           ...            ...              ...           ...   \n",
       "476           32%            6%             4%              53%            2%   \n",
       "477            3%            4%             1%              92%            0%   \n",
       "478            2%            1%             0%              96%            0%   \n",
       "479           26%            9%             5%              57%            1%   \n",
       "480           52%            5%             0%              36%            1%   \n",
       "\n",
       "    Racial%-Other  student_faculty_ratio school_type  \n",
       "0               0                   32.7      Public  \n",
       "1               2                   32.8      Public  \n",
       "2               5                   30.2      Public  \n",
       "3               6                   30.6      Public  \n",
       "4               2                    NaN         NaN  \n",
       "..            ...                    ...         ...  \n",
       "476            4%                    NaN         NaN  \n",
       "477            0%                    NaN         NaN  \n",
       "478            0%                    NaN         NaN  \n",
       "479            3%                    NaN         NaN  \n",
       "480            6%                    NaN         NaN  \n",
       "\n",
       "[481 rows x 17 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "069c2d09",
   "metadata": {},
   "source": [
    "# TASK 1: Clean missing values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "65ec6d73",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Missing Values Summary:\n",
      " School Name                0\n",
      "City                       0\n",
      "AP Classes?               89\n",
      "Dual Enrollment?          87\n",
      "Offers Electives?        103\n",
      "Math Score                25\n",
      "English Score             31\n",
      "National Rank             74\n",
      "AZ Rank                   55\n",
      "Racial%-White             21\n",
      "Racial%-Black             25\n",
      "Racial%-Native            48\n",
      "Racial%-Hispanic          20\n",
      "Racial%-Asian             37\n",
      "Racial%-Other             32\n",
      "student_faculty_ratio    201\n",
      "school_type              201\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# Calculate the summary of missing values per row and per column\n",
    "missing_values_summary = data.isnull().sum()\n",
    "print(\"Missing Values Summary:\\n\", missing_values_summary)\n",
    "\n",
    "max_missing_cols = missing_values_summary.idxmax()\n",
    "data = data.drop(columns=max_missing_cols)\n",
    "\n",
    "data = data.dropna()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "145c5e5b",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Filter out rows where 'National Rank' and 'AZ Rank' contain unwanted values\n",
    "invalid_national_rank_values = ['unranked', 'Not found', 'Unranked', 'na']\n",
    "invalid_az_rank_values = ['unranked', \"Can't Find\", 'Unranked', 'na']\n",
    "\n",
    "data = data[~data['National Rank'].isin(invalid_national_rank_values)]\n",
    "data = data[~data['AZ Rank'].isin(invalid_az_rank_values)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "5b2ff4b8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>School Name</th>\n",
       "      <th>City</th>\n",
       "      <th>AP Classes?</th>\n",
       "      <th>Dual Enrollment?</th>\n",
       "      <th>Offers Electives?</th>\n",
       "      <th>Math Score</th>\n",
       "      <th>English Score</th>\n",
       "      <th>National Rank</th>\n",
       "      <th>AZ Rank</th>\n",
       "      <th>Racial%-White</th>\n",
       "      <th>Racial%-Black</th>\n",
       "      <th>Racial%-Native</th>\n",
       "      <th>Racial%-Hispanic</th>\n",
       "      <th>Racial%-Asian</th>\n",
       "      <th>Racial%-Other</th>\n",
       "      <th>school_type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Arizona Lutheran Academy</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>28</td>\n",
       "      <td>28</td>\n",
       "      <td>3002</td>\n",
       "      <td>25</td>\n",
       "      <td>57</td>\n",
       "      <td>6</td>\n",
       "      <td>10</td>\n",
       "      <td>15</td>\n",
       "      <td>12</td>\n",
       "      <td>0</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arizona Preparatory Academy</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>17</td>\n",
       "      <td>22</td>\n",
       "      <td>19568</td>\n",
       "      <td>310</td>\n",
       "      <td>12</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "      <td>71</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Arizona School For The Arts</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>27</td>\n",
       "      <td>30</td>\n",
       "      <td>481</td>\n",
       "      <td>145</td>\n",
       "      <td>63</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Arizona Virtual Academy</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>19</td>\n",
       "      <td>32</td>\n",
       "      <td>3,635</td>\n",
       "      <td>980</td>\n",
       "      <td>69</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>15</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Mesquite High School</td>\n",
       "      <td>Gilbert</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>80</td>\n",
       "      <td>75</td>\n",
       "      <td>1841</td>\n",
       "      <td>58</td>\n",
       "      <td>60</td>\n",
       "      <td>20</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>Private</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    School Name     City AP Classes? Dual Enrollment?  \\\n",
       "0      Arizona Lutheran Academy  Phoenix         Yes              Yes   \n",
       "1   Arizona Preparatory Academy  Phoenix         Yes              Yes   \n",
       "2   Arizona School For The Arts  Phoenix         Yes              Yes   \n",
       "3       Arizona Virtual Academy  Phoenix         Yes              Yes   \n",
       "10         Mesquite High School  Gilbert         Yes              Yes   \n",
       "\n",
       "   Offers Electives? Math Score English Score National Rank AZ Rank  \\\n",
       "0                Yes         28            28          3002      25   \n",
       "1                Yes         17            22         19568     310   \n",
       "2                Yes         27            30           481     145   \n",
       "3                Yes         19            32         3,635     980   \n",
       "10               Yes         80            75          1841      58   \n",
       "\n",
       "   Racial%-White Racial%-Black Racial%-Native Racial%-Hispanic Racial%-Asian  \\\n",
       "0             57             6             10               15            12   \n",
       "1             12            11              1               71             1   \n",
       "2             63             4              1               22             5   \n",
       "3             69             6              2               15             1   \n",
       "10            60            20             10               10             5   \n",
       "\n",
       "   Racial%-Other school_type  \n",
       "0              0      Public  \n",
       "1              2      Public  \n",
       "2              5      Public  \n",
       "3              6      Public  \n",
       "10             5     Private  "
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dd99f590",
   "metadata": {},
   "source": [
    "# Task 2: Clean duplicate values "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "4e1a2d9c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Detect duplicate records based on 'School Name' and 'City'\n",
    "duplicate_records = data[data.duplicated(subset=['School Name', 'City'], keep=False)]\n",
    "duplicate_records = duplicate_records.groupby(['School Name', 'City']).agg('first').reset_index()\n",
    "\n",
    "data = data.drop_duplicates(subset=['School Name', 'City'], keep='first')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "6aba39e1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>School Name</th>\n",
       "      <th>City</th>\n",
       "      <th>AP Classes?</th>\n",
       "      <th>Dual Enrollment?</th>\n",
       "      <th>Offers Electives?</th>\n",
       "      <th>Math Score</th>\n",
       "      <th>English Score</th>\n",
       "      <th>National Rank</th>\n",
       "      <th>AZ Rank</th>\n",
       "      <th>Racial%-White</th>\n",
       "      <th>Racial%-Black</th>\n",
       "      <th>Racial%-Native</th>\n",
       "      <th>Racial%-Hispanic</th>\n",
       "      <th>Racial%-Asian</th>\n",
       "      <th>Racial%-Other</th>\n",
       "      <th>school_type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Arizona Lutheran Academy</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>28</td>\n",
       "      <td>28</td>\n",
       "      <td>3002</td>\n",
       "      <td>25</td>\n",
       "      <td>57</td>\n",
       "      <td>6</td>\n",
       "      <td>10</td>\n",
       "      <td>15</td>\n",
       "      <td>12</td>\n",
       "      <td>0</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arizona Preparatory Academy</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>17</td>\n",
       "      <td>22</td>\n",
       "      <td>19568</td>\n",
       "      <td>310</td>\n",
       "      <td>12</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "      <td>71</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Arizona School For The Arts</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>27</td>\n",
       "      <td>30</td>\n",
       "      <td>481</td>\n",
       "      <td>145</td>\n",
       "      <td>63</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Arizona Virtual Academy</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>19</td>\n",
       "      <td>32</td>\n",
       "      <td>3,635</td>\n",
       "      <td>980</td>\n",
       "      <td>69</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>15</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Mesquite High School</td>\n",
       "      <td>Gilbert</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>80</td>\n",
       "      <td>75</td>\n",
       "      <td>1841</td>\n",
       "      <td>58</td>\n",
       "      <td>60</td>\n",
       "      <td>20</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>Private</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    School Name     City AP Classes? Dual Enrollment?  \\\n",
       "0      Arizona Lutheran Academy  Phoenix         Yes              Yes   \n",
       "1   Arizona Preparatory Academy  Phoenix         Yes              Yes   \n",
       "2   Arizona School For The Arts  Phoenix         Yes              Yes   \n",
       "3       Arizona Virtual Academy  Phoenix         Yes              Yes   \n",
       "10         Mesquite High School  Gilbert         Yes              Yes   \n",
       "\n",
       "   Offers Electives? Math Score English Score National Rank AZ Rank  \\\n",
       "0                Yes         28            28          3002      25   \n",
       "1                Yes         17            22         19568     310   \n",
       "2                Yes         27            30           481     145   \n",
       "3                Yes         19            32         3,635     980   \n",
       "10               Yes         80            75          1841      58   \n",
       "\n",
       "   Racial%-White Racial%-Black Racial%-Native Racial%-Hispanic Racial%-Asian  \\\n",
       "0             57             6             10               15            12   \n",
       "1             12            11              1               71             1   \n",
       "2             63             4              1               22             5   \n",
       "3             69             6              2               15             1   \n",
       "10            60            20             10               10             5   \n",
       "\n",
       "   Racial%-Other school_type  \n",
       "0              0      Public  \n",
       "1              2      Public  \n",
       "2              5      Public  \n",
       "3              6      Public  \n",
       "10             5     Private  "
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "a6c7391c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(204, 16)"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.shape\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7eee3656",
   "metadata": {},
   "source": [
    "# Task 3: Transform the data "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "27f9131b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Final Data Size and Dimensions:\n",
      "Rows: 204\n",
      "Columns: 16\n"
     ]
    }
   ],
   "source": [
    "# Remove special characters from numeric values\n",
    "data = data.applymap(lambda x: str(x).replace('$', '').replace('%', '') if isinstance(x, str) else x)\n",
    "\n",
    "print(\"Final Data Size and Dimensions:\")\n",
    "print(\"Rows:\", data.shape[0])\n",
    "print(\"Columns:\", data.shape[1])\n",
    "\n",
    "# Save cleaned and transformed data to a new CSV file\n",
    "data.to_csv('cleaned_and_transformed.csv', index=False)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "0f7d83e1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>School Name</th>\n",
       "      <th>City</th>\n",
       "      <th>AP Classes?</th>\n",
       "      <th>Dual Enrollment?</th>\n",
       "      <th>Offers Electives?</th>\n",
       "      <th>Math Score</th>\n",
       "      <th>English Score</th>\n",
       "      <th>National Rank</th>\n",
       "      <th>AZ Rank</th>\n",
       "      <th>Racial%-White</th>\n",
       "      <th>Racial%-Black</th>\n",
       "      <th>Racial%-Native</th>\n",
       "      <th>Racial%-Hispanic</th>\n",
       "      <th>Racial%-Asian</th>\n",
       "      <th>Racial%-Other</th>\n",
       "      <th>school_type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Arizona Lutheran Academy</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>28</td>\n",
       "      <td>28</td>\n",
       "      <td>3002</td>\n",
       "      <td>25</td>\n",
       "      <td>57.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>0</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arizona Preparatory Academy</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>17</td>\n",
       "      <td>22</td>\n",
       "      <td>19568</td>\n",
       "      <td>310</td>\n",
       "      <td>12.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Arizona School For The Arts</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>27</td>\n",
       "      <td>30</td>\n",
       "      <td>481</td>\n",
       "      <td>145</td>\n",
       "      <td>63.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Arizona Virtual Academy</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>19</td>\n",
       "      <td>32</td>\n",
       "      <td>3,635</td>\n",
       "      <td>980</td>\n",
       "      <td>69.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Mesquite High School</td>\n",
       "      <td>Gilbert</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>80</td>\n",
       "      <td>75</td>\n",
       "      <td>1841</td>\n",
       "      <td>58</td>\n",
       "      <td>60.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5</td>\n",
       "      <td>Private</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>199</th>\n",
       "      <td>Franklin Police and Fire High School</td>\n",
       "      <td>Phoenix</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>43</td>\n",
       "      <td>65</td>\n",
       "      <td>4136</td>\n",
       "      <td>65</td>\n",
       "      <td>3.1</td>\n",
       "      <td>0.7</td>\n",
       "      <td>1.7</td>\n",
       "      <td>93.4</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>Private</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>200</th>\n",
       "      <td>Mountain Ridge High School</td>\n",
       "      <td>Glendale</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>51</td>\n",
       "      <td>55</td>\n",
       "      <td>2046</td>\n",
       "      <td>28</td>\n",
       "      <td>69.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>5</td>\n",
       "      <td>Public</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>201</th>\n",
       "      <td>Raymond S. Kellis</td>\n",
       "      <td>Glendale</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>48</td>\n",
       "      <td>43</td>\n",
       "      <td>7392</td>\n",
       "      <td>126</td>\n",
       "      <td>24.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5</td>\n",
       "      <td>Private</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>202</th>\n",
       "      <td>Sandra Day O'Connor High School</td>\n",
       "      <td>Glendale</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>70</td>\n",
       "      <td>69</td>\n",
       "      <td>2622</td>\n",
       "      <td>41</td>\n",
       "      <td>74.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4</td>\n",
       "      <td>Private</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>203</th>\n",
       "      <td>Deer Valley High School</td>\n",
       "      <td>Glendale</td>\n",
       "      <td>YES</td>\n",
       "      <td>YES</td>\n",
       "      <td>YES</td>\n",
       "      <td>58</td>\n",
       "      <td>51</td>\n",
       "      <td>6336</td>\n",
       "      <td>109</td>\n",
       "      <td>55.2</td>\n",
       "      <td>5.9</td>\n",
       "      <td>1.2</td>\n",
       "      <td>30.5</td>\n",
       "      <td>2.6</td>\n",
       "      <td>49.50</td>\n",
       "      <td>Private</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>204 rows Ã— 16 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                              School Name      City AP Classes?  \\\n",
       "0                Arizona Lutheran Academy   Phoenix         Yes   \n",
       "1             Arizona Preparatory Academy   Phoenix         Yes   \n",
       "2             Arizona School For The Arts   Phoenix         Yes   \n",
       "3                 Arizona Virtual Academy   Phoenix         Yes   \n",
       "4                    Mesquite High School   Gilbert         Yes   \n",
       "..                                    ...       ...         ...   \n",
       "199  Franklin Police and Fire High School   Phoenix         Yes   \n",
       "200            Mountain Ridge High School  Glendale         yes   \n",
       "201                     Raymond S. Kellis  Glendale         yes   \n",
       "202       Sandra Day O'Connor High School  Glendale         yes   \n",
       "203               Deer Valley High School  Glendale         YES   \n",
       "\n",
       "    Dual Enrollment? Offers Electives? Math Score English Score National Rank  \\\n",
       "0                Yes               Yes         28            28          3002   \n",
       "1                Yes               Yes         17            22         19568   \n",
       "2                Yes               Yes         27            30           481   \n",
       "3                Yes               Yes         19            32         3,635   \n",
       "4                Yes               Yes         80            75          1841   \n",
       "..               ...               ...        ...           ...           ...   \n",
       "199              Yes               Yes         43            65          4136   \n",
       "200              yes               yes         51            55          2046   \n",
       "201              yes               yes         48            43          7392   \n",
       "202              yes               yes         70            69          2622   \n",
       "203              YES               YES         58            51          6336   \n",
       "\n",
       "    AZ Rank  Racial%-White  Racial%-Black  Racial%-Native  Racial%-Hispanic  \\\n",
       "0        25           57.0            6.0            10.0              15.0   \n",
       "1       310           12.0           11.0             1.0              71.0   \n",
       "2       145           63.0            4.0             1.0              22.0   \n",
       "3       980           69.0            6.0             2.0              15.0   \n",
       "4        58           60.0           20.0            10.0              10.0   \n",
       "..      ...            ...            ...             ...               ...   \n",
       "199      65            3.1            0.7             1.7              93.4   \n",
       "200      28           69.0            2.0             1.0              13.0   \n",
       "201     126           24.0            8.0             1.0              57.0   \n",
       "202      41           74.0            2.0             1.0              14.0   \n",
       "203     109           55.2            5.9             1.2              30.5   \n",
       "\n",
       "     Racial%-Asian Racial%-Other school_type  \n",
       "0             12.0             0      Public  \n",
       "1              1.0             2      Public  \n",
       "2              5.0             5      Public  \n",
       "3              1.0             6      Public  \n",
       "4              5.0             5     Private  \n",
       "..             ...           ...         ...  \n",
       "199            1.0             0     Private  \n",
       "200           10.0             5      Public  \n",
       "201            5.0             5     Private  \n",
       "202            5.0             4     Private  \n",
       "203            2.6         49.50     Private  \n",
       "\n",
       "[204 rows x 16 columns]"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.read_csv('cleaned_and_transformed.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "b0b41db4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Transformation completed and saved to 'transformed_data.csv'\n"
     ]
    }
   ],
   "source": [
    "# Read the data from the CSV file\n",
    "data = pd.read_csv('cleaned_and_transformed.csv')\n",
    "\n",
    "# Define a function to convert 'Yes'/'No' to binary (1/0)\n",
    "def convert_to_binary(value):\n",
    "    if value == 'Yes' or value == 'yes' or value == 'YES':\n",
    "        return 1\n",
    "    else:\n",
    "        return 0\n",
    "\n",
    "data['AP Classes?'] = data['Offers Electives?'].apply(convert_to_binary)\n",
    "\n",
    "data['Dual Enrollment?'] = data['Dual Enrollment?'].apply(convert_to_binary)\n",
    "data['Offers Electives?'] = data['Offers Electives?'].apply(convert_to_binary)\n",
    "\n",
    "# Save the transformed data to a new CSV file\n",
    "data.to_csv('transformed_data.csv', index=False)\n",
    "\n",
    "print(\"Transformation completed and saved to 'transformed_data.csv'\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
